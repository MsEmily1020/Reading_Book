## 🔍 영속성 컨텍스트란?

엔티티 매니저는 엔티티를 영속성 컨텍스트에 저장한다는 특징이 있음.

영속성 컨텍스트는 JPA의 중요한 특징 중 하나인, 엔티티를 관리하는 가상의 공간

이것이 있으므로 데이터베이스에서 효과적으로 데이터를 가져오고 엔티티를 편하게 사용

스프링부트에서는 데이터 조작을 위한 쿼리를 자바 코드로 작성하고 이를 JPA가 알아서 쿼리로 변경해주기 때문에 편리.

<br>

### ✔ 1차 캐시
캐시의 키는 엔티티의 @Id애너테이션이 달린 기본키 역할을 하는 식별자이며 값은 엔티티이

엔티티를 조회하면 1차 캐시에서 데이터 조회, 값이 있으면 값을 반환함

값이 없으면 데이터베이스에서 조회해 1차 캐시에 저장한 다음 반환함.

이를 통해 캐시된 데이터를 조회할 때에는 데이터베이스를 거치지 않아도 되서 빠르게 데이터 조회 가능

<br>

### ✔ 쓰기 지연
transactional write-behind, 쓰기 지연은 트랜잭션을 커밋하기 전까지 데이터베이스에 실제로 질의문을 보내지 않고 쿼리를 모았다가 트랜잭션을 커밋하면 모았던 쿼리를 한번에 실행하는 것

적당한 묶음으로 쿼리를 요청할 수 있어 데이터베이스 시스템에 부담을 줄일 수 있음.

<br>

### ✔ 변경 감지
트랜잭션을 커밋하면 1차 캐시에 저장되어 있는 엔티티의 값과 현재 엔티티의 값을 비교해서 변경 된 값이 있으면 변경 사항을 감지해 변경된 값을 데이터베이스에 자동으로 반영.

쓰기 지연과 마찬가지로 적당한 묶음으로 쿼리 요청 및 데이터베이스 시스템에 부담을 줄일 수 있음.

<br>

### ✔ 지연 로딩
lazy loading, 지연 로딩은 쿼리로 요청한 데이터를 애플리케이션에 바로 로딩하는 것이 아니라

필요할 때 쿼리를 날려 데이터를 조회하는 것

(반대로 조회할 때 쿼리를 보내 연관된 모든 데이터를 가져오는 것을 즉시 로딩이라고 함)
